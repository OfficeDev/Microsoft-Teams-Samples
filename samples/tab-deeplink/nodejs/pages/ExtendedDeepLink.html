<html>
<script src="https://res.cdn.office.net/teams-js/2.34.0/js/MicrosoftTeams.min.js"
        integrity="sha384-brW9AazbKR2dYw2DucGgWCCcmrm2oBFV4HQidyuyZRI/TnAkmOOnTARSTdps3Hwt"
        crossorigin="anonymous"></script>
<script src="env.js"></script>
<script src="DeepLinkFeatures.js"></script>
<link rel="stylesheet" href="/style.css" />

<div>
    <div class="container">
        <div class="card-container-div">
            <div>
                <div class="card" style="min-height:6rem;width:45rem;">
                    <div class="card-body">
                        <div class="card-header">
                            <b>Add this app in meeting side panel and stage this tab to experience deeplink to meeting
                                side panel.</b>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-container-div">
            <div>
                <div class="card">
                    <div class="card-body">
                        <div class="card-header">
                            <b>Audio call members using the v2.0 SDK method</b>
                        </div>
                        <div class="configure-header">
                            To use this option, configure the function using following
                            parameters
                            <!-- Since we are using pre tag for having the code snippet in specified format ignoring the indentation here -->
                            <pre>
microsoftTeams.call.startCall({ targets: usersEmailArray,
        requestedModalities: [microsoftTeams.call.CallModalities.Audio]})
    .then((result) => {
        console.log(result);
    }).catch((error) => {
            console.log(error);
    });
                            </pre>
                        </div>
                        <div>Select members and make a call.</div>
                    </div>
                    <button data-id="default" class="callDeeplinkButton"
                        onclick="onCallDeepLinkButtonClick(microsoftTeams.call.CallModalities.Audio)">
                        Select
                    </button>
                </div>
            </div>
            <div>
                <div class="card">
                    <div class="card-body">
                        <div class="card-header">
                            <b>Video call members using the v2.0 SDK method</b>
                        </div>
                        <div class="configure-header">
                            To use this option, configure the function using following
                            parameters
                            <!-- Since we are using pre tag for having the code snippet in specified format ignoring the indentation here -->
                            <pre>
microsoftTeams.call.startCall({ targets: usersEmailArray,
    requestedModalities: [microsoftTeams.call.CallModalities.Video]})
.then((result) => {
    console.log(result);
}).catch((error) => {
        console.log(error);
});
                            </pre>
                        </div>
                        <div>Select members and make a call.</div>
                    </div>
                    <button class="callDeeplinkButton"
                        onclick="onCallDeepLinkButtonClick(microsoftTeams.call.CallModalities.Video)">
                        Select
                    </button>
                </div>
            </div>
        </div>
        <div class="card-container-div">
            <div>
                <div class="card">
                    <div class="card-body">
                        <div class="card-header"><b>Open a scheduling dialog</b></div>
                        <div class="configure-header">
                            To use this option, configure the function using following
                            parameters
                            <!-- Since we are using pre tag for having the code snippet in specified format ignoring the indentation here -->
                            <pre>
microsoftTeams.app.openLink("https://teams.microsoft.com/l/meeting/new?subject=Meeting Subject"
+ "&startTime=2022-07-24T10:30:00"
+ "&endTime=2022-07-24T11:30:00"
+ "&content=Meeting Content"
+ "&attendees=abc@ms.com,bcd@ms.com")
                            </pre>
                        </div>
                        <div class="form-container">
                            <form>
                                <span>Add Details for scheduling dialog</span>
                                <div class="inputContainer">
                                    <label for="Subject">Subject:</label>
                                    <input type="text" id="Subject" value="" required />
                                </div>
                                <div class="inputContainer">
                                    <label for="Content">Content:</label>
                                    <input type="text" id="Content" value="" />
                                </div>
                                <div class="inputContainer" style="display:flex;">
                                    <label for="Attendee">Attendees: </label>
                                    <input type="text" id="Attendee" value="" disabled required />
                                    <button onclick="selectPeople()" style="margin:0px 4px;">
                                        Select
                                    </button>
                                </div>
                                <div class="inputContainer">
                                    <label for="StartTime">Start Time:</label>
                                    <input type="datetime-local" id="StartTime" value="" required />
                                </div>
                                <div class="inputContainer">
                                    <label for="EndTime">End Time:</label>
                                    <input type="datetime-local" id="EndTime" value="" required />
                                </div>
                                <div class="inputContainer">
                                    <span id="dialogDeeplink"></span>
                                </div>
                            </form>
                        </div>
                    </div>
                    <button data-id="singleSelect" type="submit" class="callDeeplinkButton"
                        style="width:130px;margin-left:8.5rem;" onclick="onSchedulingDialogClick()">
                        Schedule Meeting
                    </button>
                </div>
            </div>
            <div>
                <div class="card">
                    <div class="card-body">
                        <div class="card-header">
                            <b>Open a Polly app install dialog</b>
                        </div>
                        <div class="configure-header">
                            To use this option, configure the function using following
                            parameters
                            <!-- Since we are using pre tag for having the code snippet in specified format ignoring the indentation here -->
                            <pre>
microsoftTeams.app.openLink("https://teams.microsoft.com/l/app/1542629c-01b3-4a6d-8f76-1938b779e48d");
                            </pre>
                        </div>
                    </div>
                    <button class="callDeeplinkButton" onclick="onAppInstallDialogClick()">
                        Open
                    </button>
                </div>
            </div>
        </div>
        <div class="card-container-div">
            <div>
                <div class="card">
                    <div class="card-body">
                        <div class="card-header">
                            <b>Start new chat</b>
                        </div>
                        <div class="configure-header">
                            To use this option, configure the function using following
                            parameters
                            <!-- Since we are using pre tag for having the code snippet in specified format ignoring the indentation here -->
                            <pre>
const chatPromise = chat.openGroupChat({ users: [user] });
    chatPromise.
        then((result) => { console.log(result) }).
        catch((error) => { console.log(error) });
                            </pre>
                        </div>
                    </div>
                    <button class="callDeeplinkButton"
                            onclick="startNewChat()">
                        Open
                    </button>
                </div>
            </div>
            <div>
                <div class="card">
                    <div class="card-body">
                        <div class="card-header">
                            <b>Navigate to chat (Personal chat with bot)</b>
                        </div>
                        <div class="configure-header">
                            To use this option, configure the function using following
                            parameters
                            <!-- Since we are using pre tag for having the code snippet in specified format ignoring the indentation here -->
                            <pre>
microsoftTeams.app.openLink(`https://teams.microsoft.com/l/entity/{appId}/conversations`);
                            </pre>
                        </div>
                    </div>
                    <button class="callDeeplinkButton"
                            onclick="navigateToChatWithApplication()">
                        Open
                    </button>
                </div>
            </div>
        </div>
        <div class="card-container-div">
            <div>
                <div class="card">
                    <div class="card-body">
                        <div class="card-header">
                            <b>Navigate to teams chat (Works in teams chat only)</b>
                        </div>
                        <div class="configure-header">
                            To use this option, configure the function using following
                            parameters
                            <!-- Since we are using pre tag for having the code snippet in specified format ignoring the indentation here -->
                            <pre>
const queryParameters = {
    channelId: context.channel.id,
    tenantId: context.user.tenant.id,
    groupId: context.team.groupId,
    parentMessageId: context.app.parentMessageId,
    teamName: context.team.displayName,
    channelName: context.channel.displayName
            }

microsoftTeams.app.openLink(`https://teams.microsoft.com/l/message/${queryParameters.channelId}/tenantId=${queryParameters.tenantId}&groupId=${queryParameters.groupId}&parentMessageId=${queryParameters.parentMessageId}&teamName=${queryParameters.teamName}&channelName=${queryParameters.channelName}`)
                            </pre>
                        </div>
                    </div>
                    <button class="callDeeplinkButton"
                            onclick="navigateToTeamsChat()">
                        Open
                    </button>
                </div>
            </div>
    </div>
</div>

</html>