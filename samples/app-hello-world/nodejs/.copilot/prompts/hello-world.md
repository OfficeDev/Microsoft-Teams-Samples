# Microsoft Teams Hello World Bot - Copilot Agent Prompts

<!--
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the MIT License.
-->

## Primary Use Cases

### Bot Development Patterns
```prompt
Create a Microsoft Teams bot that demonstrates:
- Message handling and echo functionality
- Tab integration with configurable content
- Messaging extensions with dynamic card generation
- Proper error handling and state management
- BotFramework v4 SDK integration patterns
```

### Agent Development Guidance
```prompt
Build a conversational agent for Microsoft Teams that:
- Responds to user messages with contextual information
- Integrates with Teams channels and personal chats
- Implements messaging extensions for rich interactions
- Follows Microsoft Teams platform best practices
- Uses modern JavaScript/Node.js patterns
```

### Code Generation Prompts
```prompt
Generate Microsoft Teams bot code that includes:
- TeamsActivityHandler for message processing
- BotFrameworkAdapter with proper error handling
- Static file serving for tab content
- RESTful API endpoints for Teams integration
- Environment-based configuration management
```

## Key Components to Reference

### Core Bot Logic (`src/bot.js`)
- `EchoBot` class extending `TeamsActivityHandler`
- Message processing with mention removal
- Conversation state management
- Error handling patterns

### Application Entry Point (`src/app.js`)
- Restify server configuration
- Static file serving setup
- API endpoint routing
- Bot and message extension initialization

### Messaging Extensions (`src/message-extension.js`)
- Query handling for search-based extensions
- Card generation with Faker.js
- Item selection processing
- Attachment layout configuration

### Tab Management (`src/tabs.js`)
- Static HTML page routing
- Content delivery patterns
- Error handling for file serving

## Common Development Scenarios

### Adding New Bot Commands
```javascript
// Example pattern for extending bot functionality
this.onMessage(async (context, next) => {
    const text = context.activity.text.trim().toLowerCase();
    
    if (text.includes('help')) {
        await context.sendActivity('Available commands: hello, status, help');
    } else if (text.includes('status')) {
        await context.sendActivity('Bot is running successfully!');
    } else {
        await context.sendActivity(`You said: ${text}`);
    }
    
    await next();
});
```

### Creating Custom Cards
```javascript
// Pattern for creating rich card responses
const cardData = {
    title: 'Custom Card',
    subtitle: 'Generated by bot',
    text: 'This is dynamic content',
    images: ['https://example.com/image.png']
};

const card = CardFactory.thumbnailCard(
    cardData.title,
    cardData.text,
    cardData.images
);
```

### Environment Configuration
```javascript
// Pattern for secure configuration management
const botConfig = {
    appId: config.get('bot.appId'),
    appPassword: config.get('bot.appPassword'),
    baseUrl: config.get('app.baseUrl')
};
```

## Integration Patterns

### Teams Platform Integration
- Bot registration and channel configuration
- Manifest file structure and permissions
- App package deployment
- Local development with tunneling

### State Management
- Memory storage for development
- Conversation state persistence
- User profile management
- Session data handling

### Error Handling
- Graceful error recovery
- User-friendly error messages
- Logging and monitoring
- State cleanup on errors

## Development Workflow

1. **Setup**: Configure bot credentials and environment
2. **Development**: Use local tunneling for Teams integration
3. **Testing**: Deploy to Teams for end-to-end testing
4. **Deployment**: Package and deploy to production

## Related Documentation
- [Microsoft Teams Platform Documentation](https://docs.microsoft.com/microsoftteams/platform/)
- [Bot Framework SDK](https://docs.microsoft.com/azure/bot-service/)
- [Teams App Manifest](https://docs.microsoft.com/microsoftteams/platform/resources/schema/manifest-schema)

## Repository Reference
When creating a minimal Node.js Teams bot that replies 'Hello, world!':

**Official Sample Repository:** https://github.com/OfficeDev/Microsoft-Teams-Samples/tree/main/samples/app-hello-world/nodejs

This sample provides a comprehensive example with:
- Echo bot functionality
- Teams activity handling
- Proper error handling
- Current timestamp: ${new Date().toISOString()}

**Clone command:**
```bash
git clone https://github.com/OfficeDev/Microsoft-Teams-Samples.git
cd Microsoft-Teams-Samples/samples/app-hello-world/nodejs
