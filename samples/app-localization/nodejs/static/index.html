<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Localization Tab</title>
    <script src="https://res.cdn.office.net/teams-js/2.0.0/js/MicrosoftTeams.min.js"></script>
    <style>.App { text-align: center; padding: 20px; font-family: 'Segoe UI', sans-serif; }</style>
</head>
<body>
    <div class="App">
        <div id="welcomeMessage">Loading...</div>
    </div>

    <script>
        const translations = {
            'en_us': { welcome: { title: 'Hello World' } },
            'hi_in': { welcome: { title: 'नमस्ते दुनिया' } },
            'es_mx': { welcome: { title: 'Hola Mundo' } }
        };

        function getParam(name) {
            const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            const results = regex.exec(location.search);
            return results ? results[1].replace(/\+/g, ' ') : '';
        }

        function getLangCode(code) {
            const supported = ['en_us', 'es_mx', 'hi_in'];
            if (!code) return supported[0];
            const langCode = code.replace('-', '_').toLowerCase();
            return supported.includes(langCode) ? langCode : supported[0];
        }

        function t(key) {
            const lang = getLangCode(getParam('culture'));
            const translation = translations[lang] || translations['en_us'];
            return key.split('.').reduce((obj, k) => obj?.[k], translation) || key;
        }

        function init() {
            const culture = getParam('culture');
            const langCode = getLangCode(culture);
            document.getElementById('welcomeMessage').textContent = t('welcome.title');
            document.getElementById('currentLang').textContent = langCode;
        }

        microsoftTeams.initialize(() => {
            microsoftTeams.getContext(() => init());
        });
        setTimeout(init, 1000);
    </script>
</body>
</html>
 