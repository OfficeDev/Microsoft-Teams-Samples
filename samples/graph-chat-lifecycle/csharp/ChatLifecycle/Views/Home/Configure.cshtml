@using ChatLifecycle.Helper;
@{
    ViewData["Title"] = "Configure";
}
<head>
    <script src="https://res.cdn.office.net/teams-js/2.34.0/js/MicrosoftTeams.min.js"
            integrity="sha384-brW9AazbKR2dYw2DucGgWCCcmrm2oBFV4HQidyuyZRI/TnAkmOOnTARSTdps3Hwt"
            crossorigin="anonymous"></script>
</head>
<body>
    <h1>Tab SSO Authentication</h1>
     
    <div id="divError" style="display: none"></div>
    <button onclick="requestConsent()" id="consent" style="display:none;">Authenticate</button>
    <div id="divGraphProfile" style="display: none"></div>

    <script>
        microsoftTeams.app.initialize().then(() => {
            microsoftTeams.pages.config.registerOnSaveHandler((saveEvent) => {
                microsoftTeams.pages.config.setConfig({
                    websiteUrl: window.location.origin ,
                    contentUrl: window.location.origin + "/Home/Index",
                    entityId: "Configure",
                    suggestedDisplayName: "Configure"
                });
                saveEvent.notifySuccess();
            });

            microsoftTeams.pages.config.setValidityState(true);
        });
    </script>
</body>
